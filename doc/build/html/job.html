

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Running a Simulation &mdash; FEPX 1.2.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Example Simulations" href="examples.html" />
    <link rel="prev" title="Simulation Output" href="output.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> FEPX
          

          
          </a>

          
            
            
              <div class="version">
                1.2.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="copying.html">Conditions of Use</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="input.html">Simulation Input</a></li>
<li class="toctree-l1"><a class="reference internal" href="output.html">Simulation Output</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Running a Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Example Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="develhistory.html">Development History</a></li>
<li class="toctree-l1"><a class="reference internal" href="refs.html">References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">FEPX</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Running a Simulation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/job.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="examples.html" class="btn btn-neutral float-right" title="Example Simulations" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="output.html" class="btn btn-neutral float-left" title="Simulation Output" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="running-a-simulation">
<span id="id1"></span><h1>Running a Simulation<a class="headerlink" href="#running-a-simulation" title="Permalink to this headline">¶</a></h1>
<p>&#64;c To run a simulation without the aid of a job scheduling program (i.e., a serial simulation, or a simulation on a single computational workstation), the &#64;samp{fepx} binary must be executed from within a prepared simulation directory. This simulation directory must contain at minimum the configuration file (&#64;file{simulation.config}) and the mesh file (&#64;file{simulation.msh}), however, additional external files may also be present as detailed elsewhere (&#64;pxref{Simulation Input}).</p>
<p>First, a simulation may be run serially – that is, on a single core – by executing the binary from the terminal,</p>
<p>&#64;inputfilehead
&#64;com{fepx}
&#64;inputfilefoot</p>
<p>However, simulations will generally require more computational resources to run in reasonable time, which can be done using a parallel computer architecture.
&#64;c
A simulation may be run in parallel utilizing MPI,</p>
<p>&#64;inputfilehead
&#64;com{mpirun -np &#64;var{N} fepx}
&#64;inputfilefoot</p>
<p>where &#64;var{N} refers to the number of MPI processes desired. Note that your local installation of MPI may not utilize &#64;samp{mpirun} and instead an alternative MPI command may be required.</p>
<p>&#64;node Submitting FEPX to a Job Scheduling Program
&#64;section Submitting FEPX to a Job Scheduling Program</p>
<p>Performing simulations on high performance computing clusters typically requires interfacing with a job scheduling program. These programs have a number of directives that are too numerous to define here. For sake of illustration, however, generic submission scripts for the Slurm and Torque job scheduling programs are provided. The generation of these scripts is highly dependent on the local configuration, and you are encouraged to work with the system administrator of your cluster if you are unsure on how to properly build a submission script. Both example scripts below are designed to submit a parallel job of FEPX to 4 nodes with 16 cores per node (i.e., 64 total tasks) to the &#64;samp{main} queue.</p>
<p>A generic submission script, &#64;file{runslurm.sh}, for submitting to a Slurm scheduler:</p>
<p>&#64;inputfilehead
&#64;example
#!/bin/bash
#SBATCH -J fepxjob
#SBATCH -q main
#SBATCH –ntasks 64
#SBATCH –ntasks-per-node 16
#SBATCH -o output.%A
#SBATCH -e errors.%A</p>
<p>srun –mpi=pmi2 fepx
&#64;end example
&#64;inputfilefoot</p>
<p>would be run by entering &#64;command{sbatch runslurm.sh} into the terminal from within the simulation directory.</p>
<p>A generic submission script, &#64;file{runtorque.sh}, for submitting to a Torque scheduler:</p>
<p>&#64;inputfilehead
&#64;example
#!/bin/bash
#PBS -N fepxjob
#PBS -q main
#PBS -l nodes=4:ppn=16
#PBS -k oe
#PBS -j oe</p>
<p># Change to the current working directory
cd $PBS_O_WORKDIR</p>
<p># Calculate the total number of cores requested
NP=`cat $PBS_NODEFILE | wc -l`</p>
<p>mpirun -np $&#64;{NP&#64;} fepx
&#64;end example
&#64;inputfilefoot</p>
<p>would be run by entering &#64;command{qsub runtorque.sh} into the terminal from within the simulation directory.</p>
<p>&#64;node Restarting a Simulation
&#64;section Restarting a Simulation</p>
<p>A simulation may be restarted only if the restart files were printed as
simulation output on the previous run (&#64;pxref{Restart Output}). Printing restart files outputs
a single &#64;samp{<a class="reference external" href="mailto:rst&#37;&#52;&#48;var{N}&#46;control">rst<span>&#64;</span>var{N}<span>&#46;</span>control</a>} file and a
&#64;samp{<a class="reference external" href="mailto:rst&#37;&#52;&#48;var{N}&#46;field">rst<span>&#64;</span>var{N}<span>&#46;</span>field</a>.core&#64;var{#}} file for each individual core, where
&#64;samp{&#64;var{N}} refers to the restart ID (0 indexing), and &#64;samp{&#64;var{#}} denotes the
ID of the core on which the data is being printed. These restart files must be
included in the simulation directory along with the configuration file, the
mesh file, and any external files included with the simulation.</p>
<p>A simulation may be restarted by adding the following line to the
&#64;file{simulation.config} file:</p>
<p>&#64;inputfilehead
&#64;example
restart on
&#64;end example
&#64;inputfilefoot</p>
<p>When a simulation restarts, it will attempt to find the simulation restart
files with the highest index, &#64;code{&#64;var{N}}. It will write output variable data to
a new set of files, &#64;samp{post.&#64;var{<a class="reference external" href="mailto:var}&#46;rst&#37;&#52;&#48;var{N}+1&#46;core*">var}<span>&#46;</span>rst<span>&#64;</span>var{N}+1<span>&#46;</span>core*</a>}, where &#64;samp{&#64;var{var}}
is the requested output variable name and &#64;samp{<a class="reference external" href="mailto:rst&#37;&#52;&#48;var{N}+1">rst<span>&#64;</span>var{N}+1</a>} is the restart
label applied to all new output variable files. Likewise, if restart files are
again printed, their index will increase to &#64;code{&#64;var{N}+2} (the previous
restart’s files will not be overwritten).</p>
<p>A simulation restart must be performed with the same number of cores that were
used to run the original simulation. Restart files are always written at the
end of a successful step and not at individual increments.</p>
<p>Each restarted simulation is considered a new simulation, albeit with
initialized field variables as written in the restart files. Step and increment
indices, as well as the simulation time, are all reset to 0.</p>
<p>When restarting a simulation, the prescribed deformation history
(&#64;pxref{Deformation History}) should include only additional steps. The
restarted simulation will attempt to follow the entire deformation history as
prescribed in the &#64;file{simulation.config} file, and will not consider steps
that were completed in the initial simulation.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="examples.html" class="btn btn-neutral float-right" title="Example Simulations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="output.html" class="btn btn-neutral float-left" title="Simulation Output" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>